<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Edison Mandir Kiosk</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: #f5f5f5;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        .debug-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .debug-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .debug-section h2 {
            color: #8B0000;
            border-bottom: 2px solid #8B0000;
            padding-bottom: 10px;
        }
        .debug-button {
            background: #8B0000;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .debug-button:hover {
            background: #A52A2A;
        }
        .debug-output {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 10px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-success { background: #28a745; }
        .status-warning { background: #ffc107; }
        .status-error { background: #dc3545; }
        .status-info { background: #17a2b8; }
        .image-preview {
            max-width: 200px;
            max-height: 150px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 10px;
        }
        .test-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .test-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
        }
        .test-card h3 {
            margin-top: 0;
            color: #495057;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1>üîß Edison Mandir Kiosk - Debug Panel</h1>
        
        <div class="debug-section">
            <h2>üß™ Image Loading Tests</h2>
            <button class="debug-button" onclick="testImageLoading()">Test Image Loading</button>
            <button class="debug-button" onclick="testAdminData()">Test Admin Data</button>
            <button class="debug-button" onclick="testLocalStorage()">Test LocalStorage</button>
            <button class="debug-button" onclick="clearDebugOutput()">Clear Output</button>
            
            <div class="debug-output" id="debug-output">Debug output will appear here...</div>
        </div>
        
        <div class="debug-section">
            <h2>üñºÔ∏è Current Image Status</h2>
            <div id="image-status">Loading image status...</div>
        </div>
        
        <div class="debug-section">
            <h2>üîó Link Tests</h2>
            <button class="debug-button" onclick="testAllLinks()">Test All Links</button>
            <button class="debug-button" onclick="testFeatureCards()">Test Feature Cards</button>
            <button class="debug-button" onclick="testNavigation()">Test Navigation</button>
            
            <div class="test-results" id="link-test-results"></div>
        </div>
        
        <div class="debug-section">
            <h2>üìä System Information</h2>
            <div id="system-info">Loading system information...</div>
        </div>
        
        <div class="debug-section">
            <h2>üöÄ Quick Actions</h2>
            <button class="debug-button" onclick="openMainKiosk()">Open Main Kiosk</button>
            <button class="debug-button" onclick="openAdminPanel()">Open Admin Panel</button>
            <button class="debug-button" onclick="refreshAllData()">Refresh All Data</button>
        </div>
    </div>

    <script>
        // Debug output management
        function log(message, type = 'info') {
            const output = document.getElementById('debug-output');
            const timestamp = new Date().toLocaleTimeString();
            const statusClass = `status-${type}`;
            
            output.innerHTML += `<div><span class="status-indicator ${statusClass}"></span>[${timestamp}] ${message}</div>`;
            output.scrollTop = output.scrollHeight;
        }
        
        function clearDebugOutput() {
            document.getElementById('debug-output').innerHTML = 'Debug output cleared...';
        }
        
        // Image loading tests
        function testImageLoading() {
            log('üß™ Starting image loading tests...', 'info');
            
            // Test localStorage data
            const savedData = localStorage.getItem('kioskData');
            if (savedData) {
                try {
                    const kioskData = JSON.parse(savedData);
                    log(`‚úÖ Found kiosk data with ${Object.keys(kioskData).length} sections`, 'success');
                    
                    if (kioskData.websiteImages) {
                        log(`üñºÔ∏è Website images found:`, 'success');
                        log(`   - Hero Slider: ${kioskData.websiteImages.heroSlider?.length || 0} images`, 'info');
                        log(`   - Murti Darshan: ${kioskData.websiteImages.murtiDarshan ? 'Yes' : 'No'}`, 'info');
                        log(`   - General Images: ${kioskData.websiteImages.generalImages?.length || 0} images`, 'info');
                        
                        updateImageStatus(kioskData.websiteImages);
                    } else {
                        log('‚ö†Ô∏è No website images found in kiosk data', 'warning');
                    }
                } catch (error) {
                    log(`‚ùå Error parsing kiosk data: ${error.message}`, 'error');
                }
            } else {
                log('üì≠ No kiosk data found in localStorage', 'warning');
            }
            
            // Test individual image data
            const websiteImagesData = localStorage.getItem('websiteImagesData');
            if (websiteImagesData) {
                log('üñºÔ∏è Found individual website images data', 'success');
                try {
                    const parsedData = JSON.parse(websiteImagesData);
                    log(`   - Hero Slider: ${parsedData.heroSlider?.length || 0} images`, 'info');
                    log(`   - Murti Darshan: ${parsedData.murtiDarshan ? 'Yes' : 'No'}`, 'info');
                    log(`   - General Images: ${parsedData.generalImages?.length || 0} images`, 'info');
                } catch (error) {
                    log(`‚ùå Error parsing website images data: ${error.message}`, 'error');
                }
            }
            
            log('‚úÖ Image loading tests completed', 'success');
        }
        
        function testAdminData() {
            log('üß™ Testing admin data...', 'info');
            
            // Check if admin panel is accessible
            try {
                const adminPassword = 'EDISONKIOSK123!';
                log(`üîë Admin password: ${adminPassword}`, 'info');
                
                // Test if we can access admin functions
                if (typeof window.testAdminFunctions === 'function') {
                    log('‚úÖ Admin functions available', 'success');
                } else {
                    log('‚ö†Ô∏è Admin functions not available (need to be on admin page)', 'warning');
                }
            } catch (error) {
                log(`‚ùå Error testing admin data: ${error.message}`, 'error');
            }
        }
        
        function testLocalStorage() {
            log('üß™ Testing localStorage...', 'info');
            
            const keys = Object.keys(localStorage);
            log(`üì¶ Found ${keys.length} localStorage keys:`, 'info');
            
            keys.forEach(key => {
                try {
                    const value = localStorage.getItem(key);
                    const size = new Blob([value]).size;
                    log(`   - ${key}: ${size} bytes`, 'info');
                } catch (error) {
                    log(`   - ${key}: Error reading value`, 'error');
                }
            });
            
            log('‚úÖ localStorage test completed', 'success');
        }
        
        // Update image status display
        function updateImageStatus(websiteImages) {
            const statusDiv = document.getElementById('image-status');
            let statusHTML = '<h3>Current Image Status:</h3>';
            
            if (websiteImages.heroSlider && websiteImages.heroSlider.length > 0) {
                statusHTML += '<div class="test-card"><h4>üé† Hero Slider Images:</h4>';
                websiteImages.heroSlider.forEach((image, index) => {
                    statusHTML += `
                        <div style="margin: 10px 0;">
                            <strong>Image ${index + 1}:</strong> ${image.title || 'Untitled'}<br>
                            <img src="${image.url}" alt="${image.title || 'Hero Image'}" class="image-preview" onerror="this.style.display='none'">
                            <small>Type: ${image.url.startsWith('data:') ? 'Base64' : 'URL'}</small>
                        </div>
                    `;
                });
                statusHTML += '</div>';
            } else {
                statusHTML += '<p>‚ö†Ô∏è No hero slider images found</p>';
            }
            
            if (websiteImages.murtiDarshan) {
                statusHTML += `
                    <div class="test-card">
                        <h4>üôè Murti Darshan Image:</h4>
                        <img src="${websiteImages.murtiDarshan}" alt="Murti Darshan" class="image-preview" onerror="this.style.display='none'">
                        <small>Type: ${websiteImages.murtiDarshan.startsWith('data:') ? 'Base64' : 'URL'}</small>
                    </div>
                `;
            } else {
                statusHTML += '<p>‚ö†Ô∏è No murti darshan image found</p>';
            }
            
            if (websiteImages.generalImages && websiteImages.generalImages.length > 0) {
                statusHTML += '<div class="test-card"><h4>üñºÔ∏è General Images:</h4>';
                websiteImages.generalImages.forEach((image, index) => {
                    statusHTML += `
                        <div style="margin: 10px 0;">
                            <strong>Image ${index + 1}:</strong> ${image.title || 'Untitled'}<br>
                            <img src="${image.url}" alt="${image.title || 'General Image'}" class="image-preview" onerror="this.style.display='none'">
                            <small>Type: ${image.url.startsWith('data:') ? 'Base64' : 'URL'}</small>
                        </div>
                    `;
                });
                statusHTML += '</div>';
            } else {
                statusHTML += '<p>‚ö†Ô∏è No general images found</p>';
            }
            
            statusDiv.innerHTML = statusHTML;
        }
        
        // Link tests
        function testAllLinks() {
            log('üîó Testing all links...', 'info');
            
            // This would normally call the main kiosk's testAllLinks function
            if (typeof window.testAllLinks === 'function') {
                const results = window.testAllLinks();
                log(`‚úÖ Link test completed: ${results.working}/${results.total} working`, 'success');
            } else {
                log('‚ö†Ô∏è testAllLinks function not available (need to be on main kiosk page)', 'warning');
            }
        }
        
        function testFeatureCards() {
            log('üéØ Testing feature cards...', 'info');
            
            const featureCards = document.querySelectorAll('.feature-card');
            if (featureCards.length > 0) {
                log(`‚úÖ Found ${featureCards.length} feature cards`, 'success');
                featureCards.forEach((card, index) => {
                    const section = card.getAttribute('data-section');
                    log(`   - Card ${index + 1}: ${section || 'No section'}`, 'info');
                });
            } else {
                log('‚ö†Ô∏è No feature cards found on this page', 'warning');
            }
        }
        
        function testNavigation() {
            log('üß≠ Testing navigation...', 'info');
            
            const navLinks = document.querySelectorAll('nav a, .navigation-menu a');
            if (navLinks.length > 0) {
                log(`‚úÖ Found ${navLinks.length} navigation links`, 'success');
                navLinks.forEach((link, index) => {
                    const href = link.getAttribute('href');
                    const text = link.textContent.trim();
                    log(`   - Link ${index + 1}: "${text}" -> ${href}`, 'info');
                });
            } else {
                log('‚ö†Ô∏è No navigation links found on this page', 'warning');
            }
        }
        
        // System information
        function updateSystemInfo() {
            const infoDiv = document.getElementById('system-info');
            const info = {
                'User Agent': navigator.userAgent,
                'Platform': navigator.platform,
                'Language': navigator.language,
                'Cookie Enabled': navigator.cookieEnabled,
                'Online': navigator.onLine,
                'Local Storage': typeof(Storage) !== "undefined" ? 'Available' : 'Not Available',
                'Session Storage': typeof(sessionStorage) !== "undefined" ? 'Available' : 'Not Available',
                'Screen Resolution': `${screen.width}x${screen.height}`,
                'Viewport': `${window.innerWidth}x${window.innerHeight}`,
                'Page URL': window.location.href,
                'Timestamp': new Date().toISOString()
            };
            
            let infoHTML = '<h3>System Information:</h3>';
            Object.entries(info).forEach(([key, value]) => {
                infoHTML += `<p><strong>${key}:</strong> ${value}</p>`;
            });
            
            infoDiv.innerHTML = infoHTML;
        }
        
        // Quick actions
        function openMainKiosk() {
            window.open('index.html', '_blank');
        }
        
        function openAdminPanel() {
            window.open('admin.html', '_blank');
        }
        
        function refreshAllData() {
            log('üîÑ Refreshing all data...', 'info');
            localStorage.clear();
            log('‚úÖ LocalStorage cleared', 'success');
            setTimeout(() => {
                location.reload();
            }, 1000);
        }
        
        // Initialize debug panel
        document.addEventListener('DOMContentLoaded', () => {
            log('üîß Debug panel initialized', 'success');
            updateSystemInfo();
            
            // Auto-refresh system info every 5 seconds
            setInterval(updateSystemInfo, 5000);
        });
        
        // Add debug functions to window for easy access
        window.debugLog = log;
        window.testImageLoading = testImageLoading;
        window.testAdminData = testAdminData;
        window.testLocalStorage = testLocalStorage;
    </script>
</body>
</html>
